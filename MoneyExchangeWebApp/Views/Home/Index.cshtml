 @using MoneyExchangeWebApp.Models;   
 @{
    string sql = @"SELECT TOP(5) BaseCurrency AS 'ISO', COUNT(*) AS 'No. of Trades' FROM ConvTransactions 
           WHERE TransactionDate = '{0: yyyy-MM-dd}'
           GROUP BY BaseCurrency ORDER BY 'No. of Trades' DESC ";

    string select = String.Format(sql, DateTime.Now);

    List<ISOMonth> ISOMonthList = DBUtl.GetList<ISOMonth>(select);

    //DataTable dt = DBUtl.GetTable(select);
    ViewData["BestToday"] = new List<ISOMonth>(ISOMonthList);

    string sql1 = @"SELECT * FROM Enquiries WHERE Status='Pending'";
    List<Enquiry> Elist = DBUtl.GetList<Enquiry>(sql1);
    if(Elist.Count == 0)
    {
        ViewData["pending"] = 0;
    }
    else
    {
        ViewData["pending"] = Elist.Count;
    }


    if (User.IsInRole("admin"))
    {
        <div class="container-fluid">
        <div class="row mt-5">
            <div class="col-lg-3 col-md-3 mb-3">
                <div class="list-group small">
                    <div class="list-group-item"><h6 class="display-6">Things to Do!</h6></div>
                    <a href="#" class="list-group-item" data-bs-toggle="modal" data-bs-target="#AddEmployee">Add an employee <i class="bi bi-people"></i></a>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#AddConvTransaction" class="list-group-item">Add a Conversion Transaction <i class="bi bi-receipt"></i></a>
                    <a asp-controller="Enquiry" asp-action="EnquiryIndex" class="list-group-item d-flex justify-content-between align-items-center">Pending enquiries 
                    <span class="badge bg-primary rounded-pill">
                        @ViewData["pending"]
                        </span></a>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#AddConvTransaction" class="list-group-item">Find top 5 currencies in the past <i class="bi bi-file-earmark-text"></i></a>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#AddConvTransaction" class="list-group-item">Deposit/Withdraw <i class="bi bi-currency-exchange"></i></a>
                </div>
            </div>
                <div class="col-sm-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Top 5 best ISOs traded today</h5>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">ISO</th>
                                        <th scope="col">No. of Trades</th>
                                    </tr>
                                </thead>
                                <tbody>
                                @{
                                    foreach(var item in ViewData["BestToday"] as List<ISOMonth>) 
                                    {
                                        <tr>
                                            <td>@item.ISO</td>
                                            <td>@item.Trades</td>
                                        </tr>
                                    }

                                }

                                </tbody>
                            </table>
                        </div>
                  </div>
                </div>
                <div class="col-sm-5">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Top 5 best ISOs traded this month</h5>
                      <table class="table ">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">ISO</th>
                                <th scope="col">No. of Trades</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                      </table>
                    </div>
                  </div>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-lg-3 col-md-3 mb-3">
            </div>
                <div class="col-sm-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Worst 5 traded today</h5>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Currency</th>
                                        <th scope="col">No. of transactions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                  </div>
                </div>
                <div class="col-sm-5">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Worst 5 currencies traded this month</h5>
                      <table class="table ">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Currency</th>
                                <th scope="col">No. of transactions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>Mark</td>
                                <td>Otto</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Jacob</td>
                                <td>Thornton</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>Mark</td>
                                <td>Otto</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Jacob</td>
                                <td>Thornton</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>Mark</td>
                                <td>Otto</td>
                            </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
            </div>
        </div>
    </div>
    }
    else
    {
        <partial name="_GuestNav" />

    <!-- Banner -->
    <partial name="_Banner" />
    <!-- Banner -->

    <!-- Features -->
    <partial name="_Features" />
    <!-- Features -->

    <!-- Exchange Rates Table & Currency Converter -->
    <partial name="ExchangeRates" />
    <!-- Exchange Rates Table & Currency Converter -->

    <!-- FAQ Slider -->
    <partial name="_FAQ" />
    <!-- FAQ Slider -->

    <!-- Enquire Us -->
    <partial name="_EnquireUs" />
    <!-- Enquire Us -->

    <!-- Comapny Details & Footer -->
    <partial name="_Footer" />
    <!-- Comapny Details & Footer -->
    }
}
    

@section Scripts{
<script src="~/js/DatatablesJS/ExchangeRates.js"></script>
<script src="~/js/LoadSlider.js"></script>
}